# Пример плагина для Obsidian

Это пример плагина для Obsidian (https://obsidian.md).

В этом проекте используется TypeScript для обеспечения проверки типов и документации.
Репозиторий зависит от последней версии API плагинов (obsidian.d.ts) в формате определений TypeScript, который содержит комментарии TSDoc с описанием функциональности.

Данный пример плагина демонстрирует некоторую базовую функциональность, которую может предоставить API плагинов:
- Добавляет значок на ленту, который при нажатии показывает уведомление.
- Добавляет команду «Open Sample Modal», которая открывает модальное окно.
- Добавляет вкладку настроек плагина на страницу параметров.
- Регистрирует глобальное событие клика и выводит «click» в консоль.
- Регистрирует глобальный интервал, который записывает «setInterval» в консоль.

## Впервые разрабатываете плагины?

Краткое руководство для новых разработчиков плагинов:

- Проверьте, [не создал ли кто-то уже плагин для вашей цели](https://obsidian.md/plugins)! Возможно, существует достаточно похожий плагин, с автором которого можно сотрудничать.
- Сделайте копию этого репозитория в качестве шаблона, нажав кнопку «Use this template» (войдите в GitHub, если не видите её).
- Клонируйте ваш репозиторий в локальную папку для разработки. Для удобства эту папку можно разместить в `.obsidian/plugins/your-plugin-name`.
- Установите NodeJS, затем выполните `npm i` в командной строке в папке вашего репозитория.
- Выполните `npm run dev`, чтобы скомпилировать ваш плагин из `main.ts` в `main.js`.
- Вносите изменения в `main.ts` (или создавайте новые файлы `.ts`). Эти изменения должны автоматически компилироваться в `main.js`.
- Перезагрузите Obsidian, чтобы загрузить новую версию вашего плагина.
- Включите плагин в окне настроек.
- Для обновлени
- я API Obsidian выполните `npm update` в командной строке в папке вашего репозитория.

## Публикация новых релизов

- Обновите ваш `manifest.json`, указав новый номер версии (например, `1.0.1`) и минимальную требуемую версию Obsidian для вашего последнего релиза.
- Обновите ваш файл `versions.json`, добавив `"новая-версия-плагина": "минимальная-версия-obsidian"`, чтобы старые версии Obsidian могли скачать совместимую старую версию вашего плагина.
- Создайте новый релиз на GitHub, используя новый номер версии в качестве «Tag version». Используйте точный номер версии без префикса `v`. Пример: https://github.com/obsidianmd/obsidian-sample-plugin/releases
- Загрузите файлы `manifest.json`, `main.js`, `styles.css` как бинарные вложения. Примечание: Файл manifest.json должен быть в двух местах — в корневом пути вашего репозитория и также в составе релиза.
- Опубликуйте релиз.

> Вы можете упростить процесс обновления версии, выполнив `npm version patch`, `npm version minor` или `npm version major` после ручного обновления `minAppVersion` в `manifest.json`.
> Команда увеличит версию в `manifest.json` и `package.json` и добавит запись для новой версии в `versions.json`.

## Добавление вашего плагина в список сообщества

- Ознакомьтесь с [рекомендациями для плагинов](https://docs.obsidian.md/Plugins/Releasing/Plugin+guidelines).
- Опубликуйте первоначальную версию.
- Убедитесь, что в корне вашего репозитория есть файл `README.md`.
- Создайте pull-request в https://github.com/obsidianmd/obsidian-releases, чтобы добавить ваш плагин.

## Ручная установка плагина

- Скопируйте `main.js`, `styles.css`, `manifest.json` в папку вашего хранилища `VaultFolder/.obsidian/plugins/your-plugin-id/`.

## Улучшение качества кода с помощью eslint (опционально)

- [ESLint](https://eslint.org/) — это инструмент для анализа кода, который помогает быстро находить проблемы. Вы можете запустить ESLint для вашего плагина, чтобы найти распространённые ошибки и способы улучшения кода.
- Чтобы использовать eslint с этим проектом, установите его глобально из терминала:
	- `npm install -g eslint`
- Чтобы проанализировать проект с помощью eslint, используйте команду:
	- `eslint main.ts`
	- eslint создаст отчёт с предложениями по улучшению кода с указанием файла и номера строки.
- Если ваш исходный код находится в папке, например, `src`, вы можете использовать eslint для анализа всех файлов в этой папке:
	- `eslint ./src/`

## URL финансирования

Вы можете указать URL, по которым пользователи вашего плагина могут финансово поддержать его.

Простой способ — установить поле `fundingUrl` в вашу ссылку в файле `manifest.json`:

```json
{
    "fundingUrl": "https://buymeacoffee.com"
}
```

## Как использовать

- Клонируйте этот репозиторий.
- Убедитесь, что у вас установлен NodeJS не ниже версии v16 (`node --version`).
- Выполните `npm i` или `yarn` для установки зависимостей.
- Выполните `npm run dev` для начала компиляции в режиме наблюдения.
```bash
	./copy-file.bat
```
- открыть my-plugin через obsidian
- [my-plugin](obsidian://open?vault=my-plugin)


## Учеба
- [Хабр статья](https://habr.com/ru/articles/861230/)
